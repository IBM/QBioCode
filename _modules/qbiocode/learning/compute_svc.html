

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qbiocode.learning.compute_svc &mdash; qbiocode 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            qbiocode
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Prerequisite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview of qbiocode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../apps/profiler.html">Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apps/sage.html">Sage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api_overview.html">API Overview</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">qbiocode</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">qbiocode.learning.compute_svc</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for qbiocode.learning.compute_svc</h1><div class="highlight"><pre>
<span></span><span class="c1"># ====== Base class imports ======</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># ====== Scikit-learn imports ======</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.multiclass</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneVsOneClassifier</span><span class="p">,</span> <span class="n">OneVsRestClassifier</span>

<span class="c1"># ====== Additional local imports ======</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qbiocode.evaluation.model_evaluation</span><span class="w"> </span><span class="kn">import</span> <span class="n">modeleval</span>
    
<div class="viewcode-block" id="compute_svc">
<a class="viewcode-back" href="../../../api/qbiocode.learning.compute_svc.html#qbiocode.learning.compute_svc.compute_svc">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_svc</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;SVC&#39;</span><span class="p">,</span> <span class="n">data_key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> 
                <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">coef0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">shrinking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> 
                <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">decision_function_shape</span><span class="o">=</span><span class="s1">&#39;ovr&#39;</span><span class="p">,</span> <span class="n">break_ties</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function generates a model using a Support Vector Classifier (svc) method as implemented in scikit-learn </span>
<span class="sd">    (https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVC.html). It takes in parameter</span>
<span class="sd">    arguments specified in the config.yaml file, but will use the default parameters specified above if none are passed.</span>
<span class="sd">    The model is trained on the training dataset and validated on the test dataset.  The model is trained on the training dataset and validated on the test dataset. </span>
<span class="sd">    The function returns the evaluation of the model on the test dataset, including accuracy, AUC, F1 score, and the time taken to train and validate the model.</span>
<span class="sd">    This function is designed to be used in a supervised learning context, where the goal is to classify data points.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_train (array-like): Training data features.</span>
<span class="sd">        X_test (array-like): Test data features.</span>
<span class="sd">        y_train (array-like): Training data labels.</span>
<span class="sd">        y_test (array-like): Test data labels.</span>
<span class="sd">        args (dict): Additional arguments, typically from a configuration file.</span>
<span class="sd">        model (str): The type of model to use, default is &#39;SVC&#39;.</span>
<span class="sd">        data_key (str): Key for the dataset, default is an empty string.</span>
<span class="sd">        C (float): Regularization parameter, default is 1.0.</span>
<span class="sd">        kernel (str): Specifies the kernel type to be used in the algorithm, default is &#39;rbf&#39;.</span>
<span class="sd">        degree (int): Degree of the polynomial kernel function (&#39;poly&#39;), default is 3.</span>
<span class="sd">        gamma (str or float): Kernel coefficient for &#39;rbf&#39;, &#39;poly&#39;, and &#39;sigmoid&#39;, default is &#39;scale&#39;.</span>
<span class="sd">        coef0 (float): Independent term in kernel function, default is 0.0.</span>
<span class="sd">        shrinking (bool): Whether to use the shrinking heuristic, default is True.</span>
<span class="sd">        probability (bool): Whether to enable probability estimates, default is False.</span>
<span class="sd">        tol (float): Tolerance for stopping criteria, default is 0.001.</span>
<span class="sd">        cache_size (int): Size of the kernel cache in MB, default is 200.</span>
<span class="sd">        class_weight (dict or None): Weights associated with classes, default is None.</span>
<span class="sd">        verbose (bool): Whether to print detailed logs, default is False.</span>
<span class="sd">        max_iter (int): Hard limit on iterations within solver, -1 means no limit, default is -1.</span>
<span class="sd">        decision_function_shape (str): Determines the shape of the decision function, default is &#39;ovr&#39;.</span>
<span class="sd">        break_ties (bool): Whether to break ties in multiclass classification, default is False.</span>
<span class="sd">        random_state (int or None): Controls the randomness of the estimator, default is None.</span>
<span class="sd">    Returns:</span>
<span class="sd">        modeleval (dict): A dictionary containing the evaluation metrics of the model, including accuracy, AUC, F1 score, and the time taken to train and validate the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
        
    <span class="n">beg_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">svc</span> <span class="o">=</span> <span class="n">OneVsOneClassifier</span><span class="p">(</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">coef0</span><span class="o">=</span><span class="n">coef0</span><span class="p">,</span> <span class="n">shrinking</span><span class="o">=</span><span class="n">shrinking</span><span class="p">,</span> 
                                 <span class="n">probability</span><span class="o">=</span><span class="n">probability</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="n">cache_size</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span> 
                                 <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">decision_function_shape</span><span class="o">=</span><span class="n">decision_function_shape</span><span class="p">,</span> 
                                 <span class="n">break_ties</span><span class="o">=</span><span class="n">break_ties</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
    <span class="c1"># Fit the training datset</span>
    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">model_params</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
    <span class="c1"># Validate the model in test dataset and calculate accuracy</span>
    <span class="n">y_predicted</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
    <span class="k">return</span><span class="p">(</span><span class="n">modeleval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">,</span> <span class="n">beg_time</span><span class="p">,</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">))</span></div>


<div class="viewcode-block" id="compute_svc_opt">
<a class="viewcode-back" href="../../../api/qbiocode.learning.compute_svc.html#qbiocode.learning.compute_svc.compute_svc_opt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_svc_opt</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;SVC&#39;</span><span class="p">,</span>
                    <span class="n">C</span><span class="o">=</span><span class="p">[],</span> <span class="n">gamma</span><span class="o">=</span><span class="p">[],</span> <span class="n">kernel</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function generates a model using a Support Vector Classifier (svc) method as implemented in scikit-learn </span>
<span class="sd">    (https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVC.html). It takes in parameter</span>
<span class="sd">    arguments specified in the config.yaml file, but will use the default parameters specified above if none are passed. The</span>
<span class="sd">    combination of parameters that led to the best performance is saved and returned as best_params, which can then be used on similar</span>
<span class="sd">    datasets, without having to run the grid search.</span>
<span class="sd">    The model is trained on the training dataset and validated on the test dataset.  The model is trained on the training dataset and validated on the test dataset. </span>
<span class="sd">    The function returns the evaluation of the model on the test dataset, including accuracy, AUC, F1 score, and the time taken to train and validate the model across the grid search.</span>
<span class="sd">    This function is designed to be used in a supervised learning context, where the goal is to classify data points.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_train (array-like): Training data features.</span>
<span class="sd">        X_test (array-like): Test data features.</span>
<span class="sd">        y_train (array-like): Training data labels.</span>
<span class="sd">        y_test (array-like): Test data labels.</span>
<span class="sd">        args (dict): Additional arguments, typically from a configuration file.</span>
<span class="sd">        verbose (bool): Whether to print detailed logs, default is False.</span>
<span class="sd">        cv (int): Number of cross-validation folds, default is 5.</span>
<span class="sd">        model (str): The type of model to use, default is &#39;SVC&#39;.</span>
<span class="sd">        C (list or float): Regularization parameter(s), default is an empty list.</span>
<span class="sd">        gamma (list or str): Kernel coefficient(s) for &#39;rbf&#39;, &#39;poly&#39;, and &#39;sigmoid&#39;, default is an empty list.</span>
<span class="sd">        kernel (list or str): Specifies the kernel type(s) to be used in the algorithm, default is an empty list.</span>
<span class="sd">     Returns:</span>
<span class="sd">        modeleval (dict): A dictionary containing the evaluation metrics of the model, including accuracy, AUC, F1 score, and the time taken to train and validate the model across the grid search.</span>
<span class="sd">    &quot;&quot;&quot;</span>   

    <span class="n">beg_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span>
            <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="n">kernel</span>
            <span class="p">}</span>
    <span class="c1"># Perform Grid Search to find the best parameters</span>
    <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVC</span><span class="p">(),</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
    <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Get the best parameters and use them to create the final SVC model</span>
    <span class="n">best_params</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span>
    <span class="n">best_svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="o">**</span><span class="n">best_params</span><span class="p">)</span>
    <span class="n">best_svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Make predictions and calculate accuracy</span>
    <span class="n">y_predicted</span> <span class="o">=</span> <span class="n">best_svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">modeleval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">,</span> <span class="n">beg_time</span><span class="p">,</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">))</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 IBM Research, Bryan Raubenolt, Aritra Bose, Kahn Rhrissorrakrai, Filippo Utro, Akhil Mohan, Daniel Blankenberg, Laxmi Parida.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>